<!DOCTYPE html>
<html>
<head>
    <title>Complete Traffic Laws Research Database</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        .content {
            padding: 40px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #3498db;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        .stat-label {
            color: #7f8c8d;
            text-transform: uppercase;
            font-size: 0.9em;
            letter-spacing: 1px;
        }
        .download-section {
            background: #ecf0f1;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 30px;
        }
        .download-btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            min-width: 200px;
        }
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }
        .csv-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        .csv-btn:hover {
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }
        .preview-section {
            margin-top: 30px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 0.85em;
            max-height: 400px;
            overflow-y: auto;
            display: block;
        }
        thead, tbody {
            display: table;
            width: 100%;
            table-layout: fixed;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            word-wrap: break-word;
        }
        th {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #e3f2fd;
        }
        .url-cell {
            max-width: 300px;
            word-break: break-all;
            font-family: monospace;
            font-size: 0.8em;
        }
        .domain-tag {
            background: #3498db;
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.75em;
            display: inline-block;
        }
        .category-tag {
            background: #e67e22;
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.75em;
        }
        .research-tag {
            background: #9b59b6;
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.75em;
        }
        .loading {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸš—ðŸ“š Complete Traffic Laws Research Database</h1>
            <p>Comprehensive integration of Motor Vehicles Act & Bharatiya Nyaya Sanhita 2023 sources</p>
        </div>
        
        <div class="content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalSources">0</div>
                    <div class="stat-label">Total Sources</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="indiaCodeSources">0</div>
                    <div class="stat-label">India Code Links</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="bnsSource">0</div>
                    <div class="stat-label">BNS 2023 Sources</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="mvaSources">0</div>
                    <div class="stat-label">MVA Sources</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="uniqueDomains">0</div>
                    <div class="stat-label">Unique Domains</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="officialSources">0</div>
                    <div class="stat-label">Official Gov Sources</div>
                </div>
            </div>

            <div class="download-section">
                <h3>ðŸ“¥ Download Complete Research Database</h3>
                <p>All sources from Motor Vehicles Act + BNS 2023 research with categorization and metadata</p>
                <button class="download-btn" onclick="downloadExcel()">
                    ðŸ“Š Download Excel (.xlsx)
                </button>
                <button class="download-btn csv-btn" onclick="downloadCSV()">
                    ðŸ“„ Download CSV
                </button>
            </div>

            <div class="preview-section">
                <h3>ðŸ“‹ Database Preview (First 20 entries)</h3>
                <div class="loading" id="loading">ðŸ”„ Loading comprehensive database...</div>
                
                <table id="sourcesTable" style="display: none;">
                    <thead>
                        <tr>
                            <th style="width: 4%;">S.No.</th>
                            <th style="width: 25%;">Document Title</th>
                            <th style="width: 30%;">URL</th>
                            <th style="width: 12%;">Domain</th>
                            <th style="width: 12%;">Category</th>
                            <th style="width: 10%;">Research Phase</th>
                            <th style="width: 7%;">Year</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const comprehensiveResearchSources = [
            // PRIMARY CENTRAL LEGISLATION
            {
                title: "India Code: Motor Vehicles Act, 1988",
                url: "https://www.indiacode.nic.in/handle/123456789/1798",
                domain: "indiacode.nic.in",
                category: "Primary Central Act",
                research_phase: "MVA Research",
                year: "1988"
            },
            {
                title: "Motor Vehicles Act 1988 PDF",
                url: "https://www.indiacode.nic.in/bitstream/123456789/15750/1/motor_vehicle_act-1988.pdf",
                domain: "indiacode.nic.in",
                category: "Primary Central Act",
                research_phase: "MVA Research",
                year: "1988"
            },
            {
                title: "India Code: Motor Vehicles (Amendment) Act, 2019",
                url: "https://www.indiacode.nic.in/handle/123456789/15751",
                domain: "indiacode.nic.in",
                category: "Amendment Act",
                research_phase: "MVA Research",
                year: "2019"
            },
            {
                title: "India Code: Bharatiya Nyaya Sanhita, 2023",
                url: "https://www.indiacode.nic.in/handle/123456789/20062",
                domain: "indiacode.nic.in",
                category: "Primary Criminal Law",
                research_phase: "BNS Research",
                year: "2023"
            },
            {
                title: "Bharatiya Nyaya Sanhita 2023 PDF",
                url: "https://www.indiacode.nic.in/bitstream/123456789/20062/1/a2023-45.pdf",
                domain: "indiacode.nic.in",
                category: "Primary Criminal Law",
                research_phase: "BNS Research",
                year: "2023"
            },
            {
                title: "Official MHA BNS 2023 PDF",
                url: "https://www.mha.gov.in/sites/default/files/250883_english_01042024.pdf",
                domain: "mha.gov.in",
                category: "Official Government",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "India Code: Bharatiya Nagarik Suraksha Sanhita, 2023",
                url: "https://www.indiacode.nic.in/handle/123456789/20099",
                domain: "indiacode.nic.in",
                category: "Criminal Procedure",
                research_phase: "BNS Research",
                year: "2023"
            },
            
            // IMPLEMENTING RULES AND REGULATIONS
            {
                title: "Central Motor Vehicles Rules, 1989 (1-164)",
                url: "https://www.indiacode.nic.in/handle/123456789/1362/simple-search?query=THE+CENTRAL+MOTOR+VEHICLES+RULES,+1989,+(1-164)&searchradio=rules",
                domain: "indiacode.nic.in",
                category: "Implementation Rules",
                research_phase: "MVA Research",
                year: "1989"
            },
            {
                title: "Central Motor Vehicles Rules, 1989",
                url: "https://www.indiacode.nic.in/handle/123456789/1362/simple-search?query=THE+CENTRAL+MOTOR+VEHICLES+RULES,+1989&searchradio=rules",
                domain: "indiacode.nic.in",
                category: "Implementation Rules",
                research_phase: "MVA Research",
                year: "1989"
            },
            
            // SUPPORTING LEGISLATION
            {
                title: "India Code: Road Transport Corporations Act, 1950",
                url: "https://www.indiacode.nic.in/handle/123456789/1541",
                domain: "indiacode.nic.in",
                category: "Supporting Legislation",
                research_phase: "MVA Research",
                year: "1950"
            },
            {
                title: "India Code: National Highways Act, 1956",
                url: "https://www.indiacode.nic.in/handle/123456789/1651",
                domain: "indiacode.nic.in",
                category: "Infrastructure Laws",
                research_phase: "MVA Research",
                year: "1956"
            },
            {
                title: "National Highways Act 1956 PDF",
                url: "https://www.indiacode.nic.in/bitstream/123456789/1651/1/AAA1956____48.pdf",
                domain: "indiacode.nic.in",
                category: "Infrastructure Laws",
                research_phase: "MVA Research",
                year: "1956"
            },
            {
                title: "India Code: Control of National Highways Act, 2002",
                url: "https://www.indiacode.nic.in/handle/123456789/11800",
                domain: "indiacode.nic.in",
                category: "Infrastructure Laws",
                research_phase: "MVA Research",
                year: "2002"
            },
            {
                title: "India Code: Control of National Highways (Land and Traffic) Act, 2002",
                url: "https://www.indiacode.nic.in/handle/123456789/2028",
                domain: "indiacode.nic.in",
                category: "Infrastructure Laws",
                research_phase: "MVA Research",
                year: "2002"
            },
            
            // ACCIDENT COMPENSATION AND INSURANCE
            {
                title: "India Code: Fatal Accidents Act, 1855",
                url: "https://www.indiacode.nic.in/handle/123456789/2276",
                domain: "indiacode.nic.in",
                category: "Accident Compensation",
                research_phase: "MVA Research",
                year: "1855"
            },
            {
                title: "India Code: Public Liability Insurance Act, 1991",
                url: "https://www.indiacode.nic.in/handle/123456789/1960",
                domain: "indiacode.nic.in",
                category: "Insurance Laws",
                research_phase: "MVA Research",
                year: "1991"
            },
            {
                title: "India Code: Insurance Act, 1938",
                url: "https://www.indiacode.nic.in/handle/123456789/2304",
                domain: "indiacode.nic.in",
                category: "Insurance Laws",
                research_phase: "MVA Research",
                year: "1938"
            },
            {
                title: "Insurance Act 1938 PDF",
                url: "https://www.indiacode.nic.in/bitstream/123456789/2304/1/a1938-04.pdf",
                domain: "indiacode.nic.in",
                category: "Insurance Laws",
                research_phase: "MVA Research",
                year: "1938"
            },
            {
                title: "Marine Insurance Act 1963 PDF",
                url: "https://www.indiacode.nic.in/bitstream/123456789/1520/1/196311.pdf",
                domain: "indiacode.nic.in",
                category: "Insurance Laws",
                research_phase: "MVA Research",
                year: "1963"
            },
            {
                title: "Employees State Insurance Act 1948 PDF",
                url: "https://www.indiacode.nic.in/bitstream/123456789/12829/1/the_employees_state_insurance_act,_1948_no._34_of_1948_date_19.04.1948.pdf",
                domain: "indiacode.nic.in",
                category: "Insurance Laws",
                research_phase: "MVA Research",
                year: "1948"
            },
            
            // STATE-SPECIFIC REGULATIONS
            {
                title: "Gujarat Motor Vehicle Rules, 1989",
                url: "https://www.indiacode.nic.in/handle/123456789/1362/simple-search?query=The+Gujarat+Motor+vehicle+rules,+1989&searchradio=rules",
                domain: "indiacode.nic.in",
                category: "State Legislation",
                research_phase: "MVA Research",
                year: "1989"
            },
            {
                title: "Delhi Motor Vehicles Rules, 1993",
                url: "https://www.indiacode.nic.in/handle/123456789/1362/simple-search?query=Delhi+Motor+Vehicles+Rules,+1993&searchradio=rules",
                domain: "indiacode.nic.in",
                category: "State Legislation",
                research_phase: "MVA Research",
                year: "1993"
            },
            {
                title: "Delhi Motor Accidents Claims Tribunal Rules, 2008",
                url: "https://www.indiacode.nic.in/handle/123456789/1362/simple-search?query=Delhi+Motor+Accidents+Claims+Tribunal+Rules,+2008&searchradio=rules",
                domain: "indiacode.nic.in",
                category: "Claims & Compensation",
                research_phase: "MVA Research",
                year: "2008"
            },
            {
                title: "Jharkhand Motor Accidents Claims Tribunal Rules, 2019",
                url: "https://www.indiacode.nic.in/handle/123456789/1362/simple-search?query=JHARKHAND+MOTOR+ACCIDENTS+CLAIMS+TRIBUNAL+RULES,+2019&searchradio=rules",
                domain: "indiacode.nic.in",
                category: "Claims & Compensation",
                research_phase: "MVA Research",
                year: "2019"
            },
            {
                title: "Mizoram Motor Vehicle Taxation (Amendment) Act, 2011",
                url: "https://www.indiacode.nic.in/handle/123456789/8988",
                domain: "indiacode.nic.in",
                category: "State Legislation",
                research_phase: "MVA Research",
                year: "2011"
            },
            {
                title: "Karnataka Motor Vehicle Rules 1989 - Indian Kanoon",
                url: "https://indiankanoon.org/search/?formInput=karnataka+motor+vehicle+rules+1989",
                domain: "indiankanoon.org",
                category: "State Legislation",
                research_phase: "MVA Research",
                year: "1989"
            },
            {
                title: "Transport FAQ - West Bengal Government",
                url: "https://transport.wb.gov.in/references/faq/",
                domain: "wb.gov.in",
                category: "State Resources",
                research_phase: "MVA Research",
                year: "N/A"
            },
            
            // SPECIFIC SECTIONS AND TECHNICAL PROVISIONS
            {
                title: "Section 184 Motor Vehicle Act Details",
                url: "https://www.indiacode.nic.in/show-data?actid=AC_CEN_30_42_00009_198859_1517807326286&orderno=24",
                domain: "indiacode.nic.in",
                category: "Specific Sections",
                research_phase: "MVA Research",
                year: "1988"
            },
            {
                title: "Suspension of driving licence provisions",
                url: "https://www.indiacode.nic.in/show-data?actid=AC_CEN_30_42_00009_198859_1517807326286&orderno=23",
                domain: "indiacode.nic.in",
                category: "Specific Sections",
                research_phase: "MVA Research",
                year: "1988"
            },
            
            // BNS SPECIFIC SECTIONS
            {
                title: "BNS Section 106 - Causing Death by Negligence",
                url: "https://devgan.in/bns/section/106/",
                domain: "devgan.in",
                category: "BNS Sections",
                research_phase: "BNS Research",
                year: "2023"
            },
            {
                title: "BNS Section 281 - Rash Driving",
                url: "https://devgan.in/bns/section/281/",
                domain: "devgan.in",
                category: "BNS Sections",
                research_phase: "BNS Research",
                year: "2023"
            },
            {
                title: "Section 281 BNS - Rash Driving Analysis",
                url: "https://sudhirrao.com/section-281-bns-section-281-of-bharatiya-nyaya-sanhita-bns/",
                domain: "sudhirrao.com",
                category: "BNS Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "BNS Section 281: Rash Driving - Testbook",
                url: "https://testbook.com/judiciary-notes/section-281-bns",
                domain: "testbook.com",
                category: "BNS Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "BNS Section 281: Rash Driving - Vakilsearch",
                url: "https://vakilsearch.com/bns/sections/281",
                domain: "vakilsearch.com",
                category: "BNS Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "BNS Section 281 - Lawrato",
                url: "https://lawrato.com/bharatiya-nyaya-sanhita/bns-section-281",
                domain: "lawrato.com",
                category: "BNS Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "Section 285 BNS - Danger in Public Way",
                url: "https://www.ezylegal.in/blogs/section-285-of-bharatiya-nyaya-sanhita-bns-2023-danger-or-obstruction-in-public-way-or-line-of-navigation",
                domain: "ezylegal.in",
                category: "BNS Sections",
                research_phase: "BNS Research",
                year: "2023"
            },
            {
                title: "BNS Section 125 - Act Endangering Life",
                url: "https://lawrato.com/bharatiya-nyaya-sanhita/bns-section-125",
                domain: "lawrato.com",
                category: "BNS Sections",
                research_phase: "BNS Research",
                year: "2023"
            },
            
            // HIT AND RUN ANALYSIS
            {
                title: "Hit and Run New Law - Vajira Mandravi",
                url: "https://vajiramandravi.com/current-affairs/hit-and-run-new-law/",
                domain: "vajiramandravi.com",
                category: "Hit-and-Run Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "Hit and Run New Law - Chahal Academy",
                url: "https://chahalacademy.com/hit-and-run-new-law",
                domain: "chahalacademy.com",
                category: "Hit-and-Run Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "Understanding Hit-and-Run Controversy - Live Law",
                url: "https://www.livelaw.in/top-stories/understanding-the-controversy-surrounding-hit-and-run-provision-under-bns-245734",
                domain: "livelaw.in",
                category: "Hit-and-Run Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "Hit and Run Law 2025 - Legal QnA",
                url: "https://thelegalqna.com/hit-and-run-new-law-in-india-2025-section-106-of-bns/",
                domain: "thelegalqna.com",
                category: "Hit-and-Run Analysis",
                research_phase: "BNS Research",
                year: "2025"
            },
            {
                title: "What is Hit and Run Law - LawBhoomi",
                url: "https://lawbhoomi.com/what-is-the-hit-and-run-law-in-india/",
                domain: "lawbhoomi.com",
                category: "Hit-and-Run Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "India's New Hit And Run Law - TruckDekho",
                url: "https://trucks.cardekho.com/en/news/detail/indias-new-hit-run-law-bns-2023-everything-you-need-to-know-2150.html",
                domain: "cardekho.com",
                category: "Hit-and-Run Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "Concerns over Hit-and-Run Law - Drishti IAS",
                url: "https://www.drishtiias.com/daily-updates/daily-news-analysis/concerns-over-hit-and-run-law",
                domain: "drishtiias.com",
                category: "Hit-and-Run Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            
            // COMPARATIVE ANALYSIS
            {
                title: "IPC vs BNS Comparison - Legal Kart",
                url: "https://www.legalkart.com/legal-blog/ipc-vs.-bns-a-comprehensive-modern-comparison-of-key-legal-sections",
                domain: "legalkart.com",
                category: "Comparative Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "Top 10 Changes BNS vs IPC - Taxmann",
                url: "https://www.taxmann.com/post/blog/top-10-changes-made-by-bns-vis-a-vis-ipc",
                domain: "taxmann.com",
                category: "Comparative Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "Section 304A IPC vs Section 106 BNS - JudiX",
                url: "https://www.myjudix.com/post/comparative-analysis-of-section-304a-ipc-and-section-106-bharatiya-nyaya-sanhita-bns-differences",
                domain: "myjudix.com",
                category: "Comparative Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "Annotated Comparison BNS and IPC - Project 39A",
                url: "https://p39ablog.com/2024/07/annotated-comparison-of-bharatiya-nyaya-sanhita-2023-and-indian-penal-code-1860/",
                domain: "p39ablog.com",
                category: "Academic Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            
            // LEGAL ANALYSIS AND COMMENTARY
            {
                title: "Motor Vehicle Act, 1988 - iPleaders Analysis",
                url: "https://blog.ipleaders.in/motor-vehicle-act-1988/",
                domain: "ipleaders.in",
                category: "Legal Analysis",
                research_phase: "MVA Research",
                year: "2024"
            },
            {
                title: "Motor Vehicles Act - Wikipedia",
                url: "https://en.wikipedia.org/wiki/Motor_Vehicles_Act",
                domain: "wikipedia.org",
                category: "Reference Material",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Bharatiya Nyaya Sanhita - Wikipedia",
                url: "https://en.wikipedia.org/wiki/Bharatiya_Nyaya_Sanhita",
                domain: "wikipedia.org",
                category: "Reference Material",
                research_phase: "BNS Research",
                year: "N/A"
            },
            {
                title: "BNS Overview - AZB Partners",
                url: "https://www.azbpartners.com/bank/overview-of-the-bharatiya-nyaya-sanhita-2023-penal-code/",
                domain: "azbpartners.com",
                category: "Legal Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "Understanding BNS - Lexology",
                url: "https://www.lexology.com/library/detail.aspx?g=9f7dd687-05f1-4785-865d-e18520becaee",
                domain: "lexology.com",
                category: "Legal Analysis",
                research_phase: "BNS Research",
                year: "2024"
            },
            
            // TRAFFIC RULES AND PENALTIES
            {
                title: "Traffic Rules and Fines - ACKO",
                url: "https://www.acko.com/traffic-rules/",
                domain: "acko.com",
                category: "Traffic Rules Guide",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Indian Motor Vehicles Act - ACKO Drive",
                url: "https://ackodrive.com/traffic-rules/motor-vehicle-act/",
                domain: "ackodrive.com",
                category: "Traffic Rules Guide",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Traffic Fines for Violations - Digit Insurance",
                url: "https://www.godigit.com/traffic-rules/revised-traffic-violation-fines-2019",
                domain: "godigit.com",
                category: "Traffic Fines",
                research_phase: "MVA Research",
                year: "2019"
            },
            {
                title: "Motor Vehicles Act Fines - Paytm",
                url: "https://paytm.com/blog/driving-licence/motor-vehicles-act-1988/",
                domain: "paytm.com",
                category: "Traffic Fines",
                research_phase: "MVA Research",
                year: "N/A"
            },
            
            // SECTION-SPECIFIC ANALYSIS
            {
                title: "Section 184 Motor Vehicle Act - PayBima",
                url: "https://www.paybima.com/blog/motor-insurance/section-184-of-the-motor-vehicle-act",
                domain: "paybima.com",
                category: "Specific Sections",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Section 184 Motor Vehicle Act - Groww",
                url: "https://groww.in/rto/section-184-motor-vehicle-act",
                domain: "groww.in",
                category: "Specific Sections",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Section 184 Motor Vehicle Act - Bajaj Allianz",
                url: "https://www.bajajallianz.com/blog/motor-insurance-articles/know-about-section-184-of-the-motor-vehicle-act.html",
                domain: "bajajallianz.com",
                category: "Specific Sections",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Section 185 MV Act - Bajaj Markets",
                url: "https://www.bajajfinservmarkets.in/resources/traffic-rules-and-violations/section-185-mv-act",
                domain: "bajajfinservmarkets.in",
                category: "Specific Sections",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Section 185 Motor Vehicles Act - Indian Kanoon",
                url: "https://indiankanoon.org/doc/139481594/",
                domain: "indiankanoon.org",
                category: "Specific Sections",
                research_phase: "MVA Research",
                year: "N/A"
            },
            
            // E-CHALLAN AND DIGITAL SERVICES
            {
                title: "Check Traffic Challan Status - CARS24",
                url: "https://www.cars24.com/traffic-challan/",
                domain: "cars24.com",
                category: "E-Challan System",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "How e-Challan Works in India - ACKO",
                url: "https://www.acko.com/traffic-rules/how-e-challan-works-in-india/",
                domain: "acko.com",
                category: "E-Challan System",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Traffic offenders e-challan rules - Business Today",
                url: "https://www.businesstoday.in/amp/latest/politics/story/traffic-offenders-to-get-e-challan-in-15-days-as-govt-tightens-rules-304567-2021-08-19",
                domain: "businesstoday.in",
                category: "Recent Updates",
                research_phase: "MVA Research",
                year: "2021"
            },
            {
                title: "Parivahan Sewa Portal - Bajaj Finserv",
                url: "https://www.bajajfinserv.in/insurance/parivahan-sewa",
                domain: "bajajfinserv.in",
                category: "Digital Services",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Parivahan Sewa - Driving Licence Portal",
                url: "https://parivahansewass.co/",
                domain: "parivahansewass.co",
                category: "Digital Services",
                research_phase: "MVA Research",
                year: "N/A"
            },
            
            // ENVIRONMENTAL STANDARDS
            {
                title: "Bharat Stage Emission Standards - Wikipedia",
                url: "https://en.wikipedia.org/wiki/Bharat_stage_emission_standards",
                domain: "wikipedia.org",
                category: "Environmental Standards",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "BS4 vs BS6 Engine Difference - ACKO",
                url: "https://www.acko.com/auto/difference-between-bsiv-bsvi-engine-bs4-bs6-performance/",
                domain: "acko.com",
                category: "Environmental Standards",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "BS6 Norms Complete Details - Spinny",
                url: "https://www.spinny.com/blog/bs6-norms-complete-details-of-bharat-stage-6-emission-standard/",
                domain: "spinny.com",
                category: "Environmental Standards",
                research_phase: "MVA Research",
                year: "N/A"
            },
            
            // GOVERNMENT RESOURCES
            {
                title: "MORTH Notifications",
                url: "https://morth.gov.in/print/notification",
                domain: "morth.gov.in",
                category: "Official Notifications",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Registration State Codes - AP Transport",
                url: "https://aptransport.org/html/registration-statecodes.html",
                domain: "aptransport.org",
                category: "State Resources",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Ministry of Home Affairs - New Criminal Laws",
                url: "https://www.mha.gov.in/en/commoncontent/new-criminal-laws",
                domain: "mha.gov.in",
                category: "Official Government",
                research_phase: "BNS Research",
                year: "2024"
            },
            {
                title: "BNS Implementation - Ministry of Home Affairs",
                url: "https://bharatiyanyayasanhita.online/implementation/",
                domain: "bharatiyanyayasanhita.online",
                category: "Implementation",
                research_phase: "BNS Research",
                year: "2024"
            },
            
            // PARLIAMENTARY AND LEGISLATIVE RESEARCH
            {
                title: "Motor Vehicles Amendment Bill 2019 - PRS India",
                url: "https://prsindia.org/billtrack/the-motor-vehicles-amendment-bill-2019",
                domain: "prsindia.org",
                category: "Legislative Analysis",
                research_phase: "MVA Research",
                year: "2019"
            },
            {
                title: "Bharatiya Nyaya Sanhita 2023 - PRS India",
                url: "https://prsindia.org/billtrack/the-bharatiya-nyaya-sanhita-2023",
                domain: "prsindia.org",
                category: "Legislative Analysis",
                research_phase: "BNS Research",
                year: "2023"
            },
            {
                title: "Bharatiya Nagarik Suraksha Sanhita 2023 - PRS India",
                url: "https://prsindia.org/billtrack/the-bharatiya-nagarik-suraksha-sanhita-2023",
                domain: "prsindia.org",
                category: "Legislative Analysis",
                research_phase: "BNS Research",
                year: "2023"
            },
            
            // AMENDMENTS AND INSURANCE
            {
                title: "Major Amendments Motor Vehicles Act 2019 - Bajaj Allianz",
                url: "https://www.bajajallianz.com/blog/motor-insurance-articles/amendments-in-motor-vehicles-act.html",
                domain: "bajajallianz.com",
                category: "Amendment Analysis",
                research_phase: "MVA Research",
                year: "2019"
            },
            {
                title: "Motor Vehicles Amendment Act 2019 - Probus Insurance",
                url: "https://www.probusinsurance.com/traffic-rules/motor-vehicle-act-2019/",
                domain: "probusinsurance.com",
                category: "Amendment Analysis",
                research_phase: "MVA Research",
                year: "2019"
            },
            
            // EDUCATIONAL AND STUDY MATERIALS
            {
                title: "Motor Vehicles Amendment Act 2019 Study - Unacademy",
                url: "https://unacademy.com/content/upsc/study-material/polity/a-study-on-motor-vehicles-amendment-act-2019/",
                domain: "unacademy.com",
                category: "Study Material",
                research_phase: "MVA Research",
                year: "2019"
            },
            {
                title: "Road Safety and Motor Vehicles Amendment Bill - Testbook",
                url: "https://testbook.com/ias-preparation/road-safety-and-motor-vehicles-amendment-bill-upsc-notes",
                domain: "testbook.com",
                category: "Study Material",
                research_phase: "MVA Research",
                year: "2019"
            },
            
            // ADDITIONAL LEGAL ANALYSIS
            {
                title: "Road Transport Laws Analysis - Legal Service India",
                url: "https://www.legalserviceindia.com/legal/article-6729-analysis-of-the-road-transport-laws-in-india.html",
                domain: "legalserviceindia.com",
                category: "Legal Analysis",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Claim Tribunals Procedures - Legal Services India",
                url: "https://www.legalservicesindia.com/article/2385/Procedures-and-Powers-of-Claim-Tribunals.html",
                domain: "legalservicesindia.com",
                category: "Claims & Compensation",
                research_phase: "MVA Research",
                year: "N/A"
            },
            {
                title: "Vehicle Registration Plates of India - Wikipedia",
                url: "https://en.wikipedia.org/wiki/Vehicle_registration_plates_of_India",
                domain: "wikipedia.org",
                category: "Registration System",
                research_phase: "MVA Research",
                year: "N/A"
            },
            
            // WEBSITE RESOURCES
            {
                title: "India Code Homepage",
                url: "https://www.indiacode.nic.in/",
                domain: "indiacode.nic.in",
                category: "Website Resources",
                research_phase: "Both",
                year: "N/A"
            },
            {
                title: "India Code User Guide",
                url: "https://www.indiacode.nic.in/help/userGuide.pdf",
                domain: "indiacode.nic.in",
                category: "Website Resources",
                research_phase: "Both",
                year: "N/A"
            },
            {
                title: "Human Rights Initiative - India Code Analysis",
                url: "https://www.humanrightsinitiative.org/in-the-news/india-code-website-laws-just-a-click-away",
                domain: "humanrightsinitiative.org",
                category: "External Analysis",
                research_phase: "MVA Research",
                year: "N/A"
            }
        ];

        function populateTable() {
            const tableBody = document.getElementById('tableBody');
            const loadingDiv = document.getElementById('loading');
            const table = document.getElementById('sourcesTable');
            
            setTimeout(() => {
                loadingDiv.style.display = 'none';
                table.style.display = 'table';
                
                // Show first 20 entries in preview
                const previewData = comprehensiveResearchSources.slice(0, 20);
                
                previewData.forEach((source, index) => {
                    const row = tableBody.insertRow();
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${source.title}</td>
                        <td class="url-cell"><a href="${source.url}" target="_blank" style="color: #3498db;">${source.url}</a></td>
                        <td><span class="domain-tag">${source.domain}</span></td>
                        <td><span class="category-tag">${source.category}</span></td>
                        <td><span class="research-tag">${source.research_phase}</span></td>
                        <td>${source.year}</td>
                    `;
                });
                
                updateStats();
            }, 1500);
        }

        function updateStats() {
            const totalSources = comprehensiveResearchSources.length;
            const indiaCodeSources = comprehensiveResearchSources.filter(s => s.domain === 'indiacode.nic.in').length;
            const bnsSource = comprehensiveResearchSources.filter(s => s.research_phase === 'BNS Research' || s.research_phase === 'Both').length;
            const mvaSources = comprehensiveResearchSources.filter(s => s.research_phase === 'MVA Research' || s.research_phase === 'Both').length;
            const uniqueDomains = new Set(comprehensiveResearchSources.map(s => s.domain)).size;
            const officialSources = comprehensiveResearchSources.filter(s => 
                s.domain.includes('.gov.in') || s.domain === 'indiacode.nic.in'
            ).length;

            document.getElementById('totalSources').textContent = totalSources;
            document.getElementById('indiaCodeSources').textContent = indiaCodeSources;
            document.getElementById('bnsSource').textContent = bnsSource;
            document.getElementById('mvaSources').textContent = mvaSources;
            document.getElementById('uniqueDomains').textContent = uniqueDomains;
            document.getElementById('officialSources').textContent = officialSources;
        }

        function downloadExcel() {
            const ws = XLSX.utils.json_to_sheet(comprehensiveResearchSources.map((source, index) => ({
                'S.No.': index + 1,
                'Document Title': source.title,
                'URL': source.url,
                'Domain': source.domain,
                'Category': source.category,
                'Research Phase': source.research_phase,
                'Year': source.year
            })));

            // Set column widths
            ws['!cols'] = [
                {wch: 5},   // S.No.
                {wch: 60},  // Document Title
                {wch: 80},  // URL
                {wch: 20},  // Domain
                {wch: 25},  // Category
                {wch: 15},  // Research Phase
                {wch: 8}    // Year
            ];

            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Complete Traffic Laws Sources");

            // Add summary sheet
            const summaryData = [
                ['Complete Traffic Laws Research Database Summary'],
                [''],
                ['Research Scope', 'Motor Vehicles Act Framework + Bharatiya Nyaya Sanhita 2023'],
                ['Research Date', new Date().toLocaleDateString()],
                ['Total Sources', comprehensiveResearchSources.length],
                ['India Code Sources', comprehensiveResearchSources.filter(s => s.domain === 'indiacode.nic.in').length],
                ['BNS 2023 Sources', comprehensiveResearchSources.filter(s => s.research_phase === 'BNS Research' || s.research_phase === 'Both').length],
                ['MVA Sources', comprehensiveResearchSources.filter(s => s.research_phase === 'MVA Research' || s.research_phase === 'Both').length],
                ['Unique Domains', new Set(comprehensiveResearchSources.map(s => s.domain)).size],
                ['Official Government Sources', comprehensiveResearchSources.filter(s => s.domain.includes('.gov.in') || s.domain === 'indiacode.nic.in').length],
                [''],
                ['Categories Covered:'],
                ['- Primary Central Acts'],
                ['- Amendment Acts'],
                ['- Implementation Rules'],
                ['- State Legislation'],
                ['- Insurance Laws'],
                ['- Infrastructure Laws'],
                ['- BNS Criminal Provisions'],
                ['- Hit-and-Run Analysis'],
                ['- Comparative Analysis'],
                ['- Traffic Rules Guides'],
                ['- E-Challan Systems'],
                ['- Environmental Standards'],
                ['- Government Resources'],
                ['- Legislative Analysis'],
                ['- Academic Research'],
                [''],
                ['Research Methodology:'],
                ['1. Comprehensive India Code website exploration'],
                ['2. Systematic document identification and categorization'],
                ['3. Integration of Motor Vehicles Act and BNS 2023 frameworks'],
                ['4. Cross-referencing with authoritative legal sources'],
                ['5. Verification of document accessibility and accuracy']
            ];
            
            const summaryWs = XLSX.utils.aoa_to_sheet(summaryData);
            summaryWs['!cols'] = [{wch: 40}, {wch: 80}];
            XLSX.utils.book_append_sheet(wb, summaryWs, "Research Summary");

            // Add category breakdown sheet
            const categories = [...new Set(comprehensiveResearchSources.map(s => s.category))];
            const categoryData = [
                ['Category', 'Count', 'Research Phase Distribution'],
                ['', '', '']
            ];
            
            categories.forEach(category => {
                const count = comprehensiveResearchSources.filter(s => s.category === category).length;
                const mvaCount = comprehensiveResearchSources.filter(s => s.category === category && (s.research_phase === 'MVA Research' || s.research_phase === 'Both')).length;
                const bnsCount = comprehensiveResearchSources.filter(s => s.category === category && (s.research_phase === 'BNS Research' || s.research_phase === 'Both')).length;
                categoryData.push([category, count, `MVA: ${mvaCount}, BNS: ${bnsCount}`]);
            });
            
            const categoryWs = XLSX.utils.aoa_to_sheet(categoryData);
            categoryWs['!cols'] = [{wch: 30}, {wch: 10}, {wch: 30}];
            XLSX.utils.book_append_sheet(wb, categoryWs, "Category Breakdown");

            XLSX.writeFile(wb, "Complete_Traffic_Laws_Research_Database.xlsx");
        }

        function downloadCSV() {
            const csvContent = [
                ['S.No.', 'Document Title', 'URL', 'Domain', 'Category', 'Research Phase', 'Year'],
                ...comprehensiveResearchSources.map((source, index) => [
                    index + 1,
                    source.title,
                    source.url,
                    source.domain,
                    source.category,
                    source.research_phase,
                    source.year
                ])
            ].map(row => row.map(field => `"${field}"`).join(',')).join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Complete_Traffic_Laws_Research_Database.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', populateTable);
    </script>
</body>
</html>